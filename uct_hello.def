include: c/posix.def

page: uct_hello, basic_frame
    module: c
    cc: gcc -std=gnu11
    $call test_main, client

page: uct_hello_server, basic_frame
    module: c
    $call test_main, server

subcode: test_main(server)
    $local char* client_target_name = NULL

    $call uct_init
    $call oob_init, $(server)

subcode: uct_init
    $local ucs_async_context_t ctx
    $fcall ucs_async_context_create, UCS_ASYNC_MODE_THREAD, &ctx
    $fcall uct_worker_create, ctx, UCS_THREAD_MODE_SINGLE, &if_info.worker

    $local uct_device_addr_t * own_dev
    $allocate(1,0) own_dev
    $allocate(1,0) own_iface
    $fcall uct_iface_get_device_address(if_info.iface, own_dev)
